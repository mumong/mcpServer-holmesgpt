apiVersion: v1
kind: ConfigMap
metadata:
  name: mcp-config
  namespace: mcp
  labels:
    app: mcp-server-manager
data:
  mcp_config.yaml: |
    # ============================================================
    # 第三方 MCP 包
    # ============================================================
    customermcp:
      - name: elasticsearch
        type: npm
        package: "@elastic/mcp-server-elasticsearch@0.3.1"
        port: 8088
        enabled: false  # 暂时禁用，待修复连接配置
        env:
          ES_URL: "https://elasticsearch:9200"
          ES_USERNAME: "elastic"
          ES_PASSWORD: "changeme"
          ES_SSL_SKIP_VERIFY: "true"
      
      # - name: kubernetes
      #   type: npm
      #   package: "mcp-server-kubernetes"
      #   port: 8093
      #   enabled: true
      
      # - name: mysql
      #   type: uv
      #   package: "mysql_mcp_server"
      #   directory: "/opt/mcp/mysql_mcp_server"
      #   port: 8084
      #   enabled: false
      #   env:
      #     MYSQL_HOST: "mysql"
      #     MYSQL_PORT: "3306"
      #     MYSQL_USER: "root"
      #     MYSQL_PASSWORD: "password"
      #     MYSQL_DATABASE: "mydb"

    # ============================================================
    # 本地自定义 MCP Server
    # ============================================================
    basicmcp:
      - name: test-tools
        path: "servers/test_server.py"
        port: 8091
        enabled: true
      
      - name: helm-tools
        path: "servers/helm_server.py"
        port: 8092
        enabled: true
      
      # K8s 只读：Holmes kubernetes/core 风格工具（kubectl describe/get/events/jq/top/lineage 等）
      - name: k8s-core
        path: "servers/k8s_core_server.py"
        port: 8093
        enabled: true
      
      - name: bash_command
        path: "servers/bash_server.py"
        port: 8094
        enabled: true
        # 黑名单：只填敏感命令名，逗号分隔即可（可选；不填则使用内置危险命令黑名单）
        env:
          BASH_BLOCKED_COMMANDS: "rm,dd,mkfs,fdisk,parted,shred,reboot,halt,poweroff,shutdown"
      
      - name: prometheus
        path: "servers/prometheus_server.py"
        port: 8095
        enabled: true
        env:
          PROMETHEUS_URL: "http://observability-prometheus.xnet.svc:9090"
      
      - name: internet
        path: "servers/internet_server.py"
        port: 8096
        enabled: true
      
      - name: connectivity_check
        path: "servers/connectivity_server.py"
        port: 8097
        enabled: true